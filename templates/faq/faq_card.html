{# ğŸ“¦ FAQ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ - ì• ë‹ˆë©”ì´ì…˜ ê°œì„  + ì•„ì´ì½˜ ì „í™˜ + ìŠ¤íƒ€ì¼ í†µì¼ #}
<div class="faq-card-js bg-gray-700 rounded-xl shadow-lg p-6 border border-gray-600 mb-6 text-white">
  <div class="faq-summary-js cursor-pointer select-none">
    <div class="flex flex-wrap justify-between items-center">
      <div class="flex flex-col gap-1">
        <!-- ì¹´í…Œê³ ë¦¬ì™€ êµ¬ì—­ ì •ë³´ -->
        <div class="flex gap-3 text-sm text-gray-300">
          <span>ğŸ“‚ {{ faq.category }}</span>
          <span>ğŸ“ {{ faq.area }}</span>
        </div>
        <!-- ì§ˆë¬¸ -->
        <div class="flex items-center gap-2">
          <span class="faq-toggle-icon transition-transform duration-200 text-purple-300">â–¶</span>
          <h3 class="text-lg font-bold text-white break-words">Q. {{ faq.question }}</h3>
        </div>
      </div>

      <!-- ì¦ê²¨ì°¾ê¸° + ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ -->
      <div class="flex items-center gap-3 mt-4 sm:mt-0">
        <span title="ì¦ê²¨ì°¾ê¸°" class="text-lg cursor-pointer text-yellow-400">â­</span>
        {% if user.is_authenticated %}
        <a href="{% url 'faq:edit_faq' faq.id %}?{{ request.GET.urlencode }}" title="ìˆ˜ì •"
           class="text-purple-300 hover:text-purple-400 text-lg">âœï¸</a>
        <form method="post" action="{% url 'faq:delete_faq' faq.id %}?{{ request.GET.urlencode }}" class="inline">
          {% csrf_token %}
          <button type="submit" title="ì‚­ì œ" class="text-red-400 hover:text-red-500 text-lg">ğŸ—‘ï¸</button>
        </form>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- í¼ì³ì§€ëŠ” ë‹µë³€ ì˜ì—­ -->
  <div class="faq-answer-js max-h-0 opacity-0 overflow-hidden transition-[max-height,opacity] duration-500 ease-in-out" data-open="false">
    <div class="text-gray-200 mt-3">
      <p class="leading-relaxed">{{ faq.answer|safe }}</p>
      {% if faq.image %}
      <div class="mt-4">
        <img src="{{ faq.image.url }}" alt="FAQ ì´ë¯¸ì§€" class="max-w-full rounded-lg">
      </div>
      {% endif %}

      <!-- ìƒì„±ì¼ì, ì¡°íšŒìˆ˜ -->
      <div class="mt-6 flex flex-wrap gap-3 text-sm text-gray-400">
        <span>ğŸ•’ {{ faq.created_at|date:"Y-m-d" }}</span>
        <span>ğŸ‘ï¸ {{ faq.view_count }}íšŒ</span>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const summaries = document.querySelectorAll(".faq-summary-js");

    summaries.forEach((summary) => {
      summary.addEventListener("click", () => {
        const card = summary.closest(".faq-card-js");
        const wrapper = card.querySelector(".faq-answer-js");
        const icon = card.querySelector(".faq-toggle-icon");
        const isOpen = wrapper.getAttribute("data-open") === "true";

        // ë‹¤ë¥¸ ì¹´ë“œ ë‹«ê¸°
        document.querySelectorAll(".faq-card-js").forEach((c) => {
          const otherWrapper = c.querySelector(".faq-answer-js");
          const otherIcon = c.querySelector(".faq-toggle-icon");
          if (c !== card && otherWrapper.getAttribute("data-open") === "true") {
            otherWrapper.style.maxHeight = "0px";
            otherWrapper.style.opacity = "0";
            otherWrapper.setAttribute("data-open", "false");
            if (otherIcon) otherIcon.textContent = "â–¶";
          }
        });

        if (isOpen) {
          wrapper.style.maxHeight = wrapper.scrollHeight + "px";
          requestAnimationFrame(() => {
            wrapper.style.maxHeight = "0px";
            wrapper.style.opacity = "0";
            wrapper.setAttribute("data-open", "false");
            if (icon) icon.textContent = "â–¶";
          });
        } else {
          wrapper.style.maxHeight = "0px";
          wrapper.style.opacity = "0";
          wrapper.setAttribute("data-open", "true");
          if (icon) icon.textContent = "â–¼";
          requestAnimationFrame(() => {
            wrapper.style.maxHeight = wrapper.scrollHeight + "px";
            wrapper.style.opacity = "1";
          });

          wrapper.addEventListener("transitionend", function handler() {
            if (wrapper.getAttribute("data-open") === "true") {
              wrapper.style.maxHeight = "none";
            }
            wrapper.removeEventListener("transitionend", handler);
          });
        }
      });
    });
  });
</script>
